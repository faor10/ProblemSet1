load("C:/Users/francisco.alejandro1/Documents/BD/ProblemSet1/stores/taller1.RData")
##PUNTO 3##
install.packages("stargazer")
install.packages("pacman")
install.packages("tidyverse")
require(tidyverse)
require(stargazer)
require(pacman)
##How good is this model in sample fit?
##Para esto debemos hacer la regresión y ver el R-cuadrado
summary(db_imputado$ingtot)
db_imputado<- db_imputado %>% mutate(age2 = age^2)
mod_1<-lm(ingtot~age+age2,db_imputado)
summary(mod_1)
stargazer(mod_1,type="text",title="Regresión ingresos-edad", out="mod1.txt")
##Plot the predicted age-earnings profile implied by the above equation
plot(x=db_imputado$age, y=predict(mod_1),
xlab='edad',
ylab='valores predichos',
main='Ingreso predicho vs Edad')
lines(sort(db_imputado$age),                 # Draw polynomial regression curve
fitted(mod_1)[order(db_imputado$age)],
col = "blue",
type = "l")
##What is the “peak age” suggested by the above equation? Use bootstrap to
##calculate the standard errors and construct the confidence intervals.
coefs<-mod_1$coef
coefs
b1<-coefs[2]
b2<-coefs[3]
##Para sacar Peak age toca derivar e igualar a 0 (derivada=B1+2B2AGE)
b1
b2
b1+b2
Peakage=(-b1)/(2*b2)
Peakage
##Usa bootstap para calcular Error estándar y construir IDC
mean_age<-mean(db_imputado$age)
elast_ingreso_edad<-b1+2*b2*mean_age ##para comprobar que el bootstrap esta bien
elast_ingreso_edad
eta_mod1.fn<-function(data,index,
mean_age=mean(db_imputado$age),
mean_age2=mean(db_imputado$age2)){
mod_2<-lm(ingtot~age+age2, db_imputado, subset = index)
coefs<-mod_2$coefficients
B1<-coefs[2]
B2<-coefs[3]
elastpt<-B1+2*B2*mean_age
return(elastpt)
}
require(boot)
results<-boot(data=db_imputado, eta_mod1.fn,R=1000)
results
elast_ingreso_edad
##Intervalos de confianza
boot.ci(results,conf=0.95,
type = c("norm", "basic",
"perc", "bca"))
quantile(results, c(0.025, 0.975))
##Estimate the unconditional earnings gap
db_imputado<- db_imputado %>% mutate(mujer = ifelse(db_imputado$sex == 0, 1, 0))
db_imputado<-db_imputado %>% mutate(log_ingreso=log(db_imputado$ingtot))
mod_3<-lm(log_ingreso~mujer,db_imputado)
mod_3
stargazer(mod_3,type="text",title="Regresión ingresos-mujer", out="mod_3.txt")
##Estimate and plot the predicted age-earnings profile by gender. Do men and
##women in Bogota have the same intercept and slopes?
mod_4<-lm(log_ingreso~age+age2+mujer,db_imputado)
mod_4
stargazer(mod_4,type="text",title="Regresión ingresos-edad-genero", out="mod_4.txt")
mod_5<-lm(ingtot~age+age2+mujer,db_imputado)
mod_5
stargazer(mod_5,type="text",title="Regresión lineal ingresos-edad-genero", out="mod_5.txt")
plot(x=db_imputado$age, y=predict(mod_4),
xlab='edad',
ylab='valores predichos',
main='Ingreso predicho vs Edad (por genero)')
lines(sort(db_imputado$age),                 # Draw polynomial regression curve
fitted(mod_4)[order(db_imputado$age)],
col = "blue",
type = "l")
ggplot(db_imputado, aes(x = age, y =predict(mod_4))) +
geom_point() +
facet_grid(mujer)
ggplot(db_imputado, aes(x =age, y =predict(mod_4))) +
geom_point() +
facet_grid(mujer)
plot(db_imputado$log_ingreso, db_imputado$age,
col = ifelse(db_imputado$mujer == "1", "red", "blue"),
main = "Regresión Ingreso vs Edad (por género)",
xlab = "Ingreso (Log del ingreso)",
ylab = "Edad")
plot(db_imputado$age,db_imputado$log_ingreso
col = ifelse(db_imputado$mujer == "1", "red", "blue"),
main = "Regresión Ingreso vs Edad (por género)",
xlab = "Ingreso (Log del ingreso)",
ylab = "Edad")
plot(db_imputado$age, db_imputado$log_ingreso,
col = ifelse(db_imputado$mujer == "1", "red", "blue"),
main = "Regresión Ingreso vs Edad (por género)",
xlab = "Ingreso (Log del ingreso)",
ylab = "Survival Time (in days)")
plot(db_imputado$age, db_imputado$log_ingreso,
col = ifelse(db_imputado$mujer == "1", "red", "blue"),
main = "Regresión Ingreso vs Edad (por género)",
xlab = "Ingreso (Log del ingreso)",
ylab = "Ingreso (log del ingreso")
plot(db_imputado$age, db_imputado$log_ingreso,
col = ifelse(db_imputado$mujer == "1", "red", "blue"),
main = "Regresión Ingreso vs Edad (por género)",
xlab = "Edad",
ylab = "Ingreso (log del ingreso")
plot(db_imputado$age, predict(mod_4),
main = "Regresión Ingreso vs Edad (por genero)",
xlab = "Ingreso (log ingreso)",
ylab = "Edad)",
col = ifelse(db_imputado$mujer == "1", "red", "blue"))
legend("topleft",
pch = c(1, 1),
c("Female", "Male"),
col = c("red", "blue"))
abline(lm(log_ingreso~age+age2+mujer), col = "red")
plot(db_imputado$age, predict(mod_4),
main = "Regresión Ingreso vs Edad (por genero)",
xlab = "Ingreso (log ingreso)",
ylab = "Edad)",
col = ifelse(db_imputado$mujer == "1", "red", "blue"))
legend("topleft",
pch = c(1, 1),
c("Female", "Male"),
col = c("red", "blue"))
abline(lm(db_imputado$log_ingreso~age+age2+mujer), col = "red")
abline(lm(melanoma_male$time ~ melanoma_male$age), col = "blue")
plot(db_imputado$age, predict(mod_4),
main = "Regresión Ingreso vs Edad (por genero)",
xlab = "Ingreso (log ingreso)",
ylab = "Edad)",
col = ifelse(db_imputado$mujer == "1", "red", "blue"))
legend("topleft",
pch = c(1, 1),
c("Female", "Male"),
col = c("red", "blue"))
abline(lm(db_imputado$log_ingreso~age+age2+mujer), col = "red")
plot(db_imputado$age, predict(mod_4),
main = "Regresión Ingreso vs Edad (por genero)",
xlab = "Ingreso (log ingreso)",
ylab = "Edad)",
col = ifelse(db_imputado$mujer == "1", "red", "blue"))
legend("topleft",
pch = c(1, 1),
c("Female", "Male"),
col = c("red", "blue"))
abline(lm(db_imputado$log_ingreso~dm_imputado$age+db_imputado$age2+db_imputado$mujer), col = "red")
plot(db_imputado$age, predict(mod_4),
main = "Regresión Ingreso vs Edad (por genero)",
xlab = "Ingreso (log ingreso)",
ylab = "Edad)",
col = ifelse(db_imputado$mujer == "1", "red", "blue"))
legend("topleft",
pch = c(1, 1),
c("Female", "Male"),
col = c("red", "blue"))
abline(lm(db_imputado$log_ingreso~db_imputado$age+db_imputado$age2+db_imputado$mujer), col = "red")
ggplot(data = db_imputado, aes(x = age, y = predict(mod_4), color = mujer)) +
geom_point() +
labs(title = "Survival Time from Malignant Melanoma",
x = "Age (in years)",
y = "Survival Time (in days)")
lines(sort(db_imputado$age),                 # Draw polynomial regression curve
fitted(mod_4)[order(db_imputado$age)],
col = "blue",
type = "l")
ggplot(data = db_imputado, aes(x = age, y = predict(mod_4), color = mujer)) +
geom_point() +
labs(title = "Regresión Log Ingreso vs Edad (por genero)",
x = "Edad",
y = "Ingreso (log ingreso)")
lines(sort(db_imputado$age),                 # Draw polynomial regression curve
fitted(mod_4)[order(db_imputado$age)],
col = "blue",
type = "l")
ggplot(data = db_imputado, aes(x = age, y = predict(mod_4), color = mujer)) +
geom_point() +
labs(title = "Regresión Log Ingreso vs Edad (por genero)",
x = "Edad",
y = "Ingreso (log ingreso)")
lines(sort(db_imputado$age),                 # Draw polynomial regression curve
fitted(mod_4)[order(db_imputado$mujer)],
col = "blue",
type = "l")
ggplot(data = db_imputado, aes(x = age, y = predict(mod_4), color = mujer)) +
geom_point() +
labs(title = "Regresión Log Ingreso vs Edad (por genero)",
x = "Edad",
y = "Ingreso (log ingreso)")
lines(sort(db_imputado$age),                 # Draw polynomial regression curve
fitted(mod_4,db_imputado$mujer=1)[order(db_imputado$mujer)],
col = "blue",
type = "l")
ggplot(data = db_imputado, aes(x = age, y = predict(mod_4), factor = mujer)) +
geom_point() +
labs(title = "Regresión Log Ingreso vs Edad (por genero)",
x = "Edad",
y = "Ingreso (log ingreso)")
lines(sort(db_imputado$age),                 # Draw polynomial regression curve
fitted(mod_4,db_imputado$mujer=1)[order(db_imputado$mujer)],
col = "blue",
type = "l")
ggplot(data = db_imputado, aes(x = age, y = predict(mod_4), color = mujer)) +
geom_point() +
labs(title = "Regresión Log Ingreso vs Edad (por genero)",
x = "Edad",
y = "Ingreso (log ingreso)")
lines(sort(db_imputado$age),                 # Draw polynomial regression curve
fitted(mod_4,db_imputado$mujer=1)[order(db_imputado$mujer)],
col = "blue",
type = "l")
ggplot(data = db_imputado, aes(x = age, y = predict(mod_4), shape = factor(mujer))) +
geom_point() +
labs(title = "Regresión Log Ingreso vs Edad (por genero)",
x = "Edad",
y = "Ingreso (log ingreso)")
lines(sort(db_imputado$age),                 # Draw polynomial regression curve
fitted(mod_4,db_imputado$mujer=1)[order(db_imputado$mujer)],
col = "blue",
type = "l")
ggplot(data = db_imputado, aes(x = age, y = predict(mod_4), shape = factor(mujer))) +
geom_point() +
labs(title = "Regresión Log Ingreso vs Edad (por genero)",
x = "Edad",
y = "Ingreso (log ingreso)")
lines(sort(db_imputado$age),                 # Draw polynomial regression curve
fitted(mod_4)[order(db_imputado$edad)],
col = "blue",
type = "l")
ggplot(data = db_imputado, aes(x = age, y = predict(mod_4), shape = factor(mujer))) +
geom_point() +
labs(title = "Regresión Log Ingreso vs Edad (por genero)",
x = "Edad",
y = "Ingreso (log ingreso)")+
aes(color = factor(mujer)))
lines(sort(db_imputado$age),                 # Draw polynomial regression curve
fitted(mod_4)[order(db_imputado$edad)],
col = "blue",
type = "l")
ggplot(data = db_imputado, aes(x = age, y = predict(mod_4), shape = factor(mujer))) +
geom_point() +
labs(title = "Regresión Log Ingreso vs Edad (por genero)",
x = "Edad",
y = "Ingreso (log ingreso)")+
aes(color = factor(mujer)))
lines(sort(db_imputado$age),                 # Draw polynomial regression curve
fitted(mod_4)[order(db_imputado$age)],
col = "blue",
type = "l")
ggplot(data = db_imputado, aes(x = age, y = predict(mod_4), shape = factor(mujer))) +
geom_point() +
labs(title = "Regresión Log Ingreso vs Edad (por genero)",
x = "Edad",
y = "Ingreso (log ingreso)")
aes(color = factor(mujer)))
lines(sort(db_imputado$age),                 # Draw polynomial regression curve
fitted(mod_4)[order(db_imputado$age)],
col = "blue",
type = "l")
ggplot(data = db_imputado, aes(x = age, y = predict(mod_4), shape = factor(mujer))) +
geom_point() +
labs(title = "Regresión Log Ingreso vs Edad (por genero)",
x = "Edad",
y = "Ingreso (log ingreso)") +
aes(color = factor(mujer)))
lines(sort(db_imputado$age),                 # Draw polynomial regression curve
fitted(mod_4)[order(db_imputado$age)],
col = "blue",
type = "l")
ggplot(data = db_imputado, aes(x = age, y = predict(mod_4), shape = factor(mujer), aes(color = factor(mujer))) +
geom_point() +
labs(title = "Regresión Log Ingreso vs Edad (por genero)",
x = "Edad",
y = "Ingreso (log ingreso)")
lines(sort(db_imputado$age),                 # Draw polynomial regression curve
fitted(mod_4)[order(db_imputado$age)],
col = "blue",
type = "l")
ggplot(data = db_imputado, aes(x = age, y = predict(mod_4), color = mujer)) +
geom_point() +
labs(title = "Regresión Log Ingreso vs Edad (por genero)",
x = "Edad",
y = "Ingreso (log ingreso)")
lines(sort(db_imputado$age),                 # Draw polynomial regression curve
fitted(mod_4)[order(db_imputado$age)],
col = "blue",
type = "l")
ggplot(data = db_imputado, aes(x = age, y = predict(mod_4))) +
geom_point(aes(shape = factor(mujer))) +
geom_point(aes(color = factor(mujer))) +
geom_smooth(method = "lm",
se = FALSE,
aes(color = factor(mujer))) +
labs(title = "Regresión Log ingreso vs Edad (por genero)",
x = "Edad",
y = "Ingreso (log ingreso)")
ggplot(data = db_imputado, aes(x = age, y = predict(mod_4))) +
geom_point(aes(shape = factor(mujer))) +
geom_point(aes(color = factor(mujer))) +
geom_smooth(method = lm(log_ingreso~age+age2+mujer,db_imputado),
se = FALSE,
aes(color = factor(mujer))) +
labs(title = "Regresión Log ingreso vs Edad (por genero)",
x = "Edad",
y = "Ingreso (log ingreso)")
stargazer(mod_5,type="text",title="Regresión lineal ingresos-edad-genero 2", out="mod_5.txt")
coefs1<-mod_4$coef
coefs1
b_1<-coefs1[2]
b_2<-coefs1[3]
b_3<-coefs1[4]
db_imputado<- db_imputado %>% mutate(mujer_age = mujer*age)
mod_6<-lm(log_ingreso~age+age2+mujer+mujer_age,db_imputado)
mod_6
stargazer(mod_6,type="text",title="Regresión lineal ingresos-edad-genero-edad*genero", out="mod_6.txt")
ggplot(data = db_imputado, aes(x = age, y = predict(mod_6))) +
geom_point(aes(shape = factor(mujer))) +
geom_point(aes(color = factor(mujer))) +
geom_smooth(method = lm(log_ingreso~age+age2+mujer+mujer_age,db_imputado),
se = FALSE,
aes(color = factor(mujer))) +
labs(title = "Regresión Log ingreso vs Edad (por genero)",
x = "Edad",
y = "Ingreso (log ingreso)")
coefs1<-mod_6$coef
coefs1
b_1<-coefs1[2]
b_2<-coefs1[3]
b_3<-coefs1[4]
b_4<-coefs1[5]
b_1
b_2
b_3
b_4
Peakage_mujer=(-b_1-b_4)/(2*b_2)
Peakage_mujer
Peakage_hombre=(-b_1)/(2*b_2)
Peakage_hombre
